import{j as e,e as s,p as a,r as i,m as n,b as t,A as r}from"./index-K5uqA-3n.js";const l=({className:s,size:a=24,color:i="currentColor"})=>e.jsx("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",className:s,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M6.5 9.5V6C6.5 5.44772 6.94772 5 7.5 5H16.5C17.0523 5 17.5 5.44772 17.5 6V9.5M6.5 9.5C6.5 11.433 8.067 13 10 13H10.5M6.5 9.5H3.5C3.5 11.433 5.067 13 7 13H8M17.5 9.5C17.5 11.433 15.933 13 14 13H13.5M17.5 9.5H20.5C20.5 11.433 18.933 13 17 13H16M10.5 13L11 19H13L13.5 13M10.5 13H13.5M8 19H16",stroke:i,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),c=({className:s,size:a=24,color:i="currentColor"})=>e.jsx("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",className:s,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 6.253v13m0-13c-1.198-1.198-2.697-1.753-4.253-1.753-1.556 0-3.055.555-4.253 1.753v11c1.198-1.198 2.697-1.753 4.253-1.753 1.556 0 3.055.555 4.253 1.753m0-13c1.198-1.198 2.697-1.753 4.253-1.753 1.556 0 3.055.555 4.253 1.753v11c-1.198-1.198-2.697-1.753-4.253-1.753-1.556 0-3.055.555-4.253 1.753",stroke:i,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),d=({className:s,size:a=24,color:i="currentColor"})=>e.jsx("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",className:s,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",stroke:i,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),o=({className:s,size:a=24,color:i="currentColor"})=>e.jsx("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",className:s,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15",stroke:i,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),h=({className:s,size:a=24,color:i="currentColor"})=>e.jsx("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",className:s,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M8 6h.01M8 12h.01M8 18h.01M12 6h.01M12 12h.01M12 18h.01M16 6h.01M16 12h.01M16 18h.01",stroke:i,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),m=({className:s,size:a=24,color:i="currentColor"})=>e.jsx("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",className:s,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z",stroke:i,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),p=({className:s,size:a=24,color:i="currentColor"})=>e.jsx("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:"none",className:s,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",stroke:i,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),_=e=>{const s={flashcards:{frontSides:["side_a"],backSides:["side_b"],progressionMode:"shuffle",includeMastered:!0,enableTimer:!1,timerSeconds:30,enableAudio:!1,groupSides:{}},learn:{questionSides:["side_a"],answerSides:["side_b"],cardsPerRound:10,randomize:!0,enableTimer:!1,timerSeconds:30,enableAudio:!1,questionTypeMix:"auto",progressionMode:"sequential",schedulingAlgorithm:"smart_spaced",masteryThreshold:3,progressiveLearning:"spaced",progressiveLearningSpacing:3,questionTypes:["multiple_choice","free_text"],adaptiveDifficulty:!1,frontSides:["side_a"],backSides:["side_b"]},match:{frontSides:["side_a"],backSides:["side_b"],cardsPerRound:12,enableTimer:!0,timerSeconds:60,enableAudio:!0,randomize:!0,progressionMode:"random"},test:{frontSides:["side_a"],backSides:["side_b"],cardsPerRound:20,enableTimer:!1,timerSeconds:1800,enableAudio:!1,randomize:!0,progressionMode:"sequential"},read:{answerType:"free_text",checkMode:"wait",translationDirection:{from:"a",to:"c"},optionsCount:4,showPinyinDefault:!1,multipleChoiceDifficulty:"medium",unit:"character",translationMode:"sentence",accuracyThreshold:70,showWordHints:!0}};return s[e]||s.flashcards},u=s()(a((e,s)=>({flashcardsSettings:{},learnSettings:{},matchSettings:{},testSettings:{},readSettings:{},presetSelections:{},getSettingsForMode:(e,a)=>{const i=s();switch(a){case"flashcards":return i.flashcardsSettings[e]||_("flashcards");case"learn":return i.learnSettings[e]||_("learn");case"match":return i.matchSettings[e]||_("match");case"test":return i.testSettings[e]||_("test");case"read":return i.readSettings[e]||_("read");default:return _(a)}},updateSettings:(s,a,i)=>{e(e=>{switch(a){case"flashcards":return{...e,flashcardsSettings:{...e.flashcardsSettings,[s]:i}};case"learn":return{...e,learnSettings:{...e.learnSettings,[s]:i}};case"match":return{...e,matchSettings:{...e.matchSettings,[s]:i}};case"test":return{...e,testSettings:{...e.testSettings,[s]:i}};case"read":return{...e,readSettings:{...e.readSettings,[s]:i}};default:return e}})},applyPreset:(s,a,i)=>{e(e=>({...e,presetSelections:{...e.presetSelections,[s]:{...e.presetSelections[s],[a]:i}}}))},getSettings:e=>{const s=localStorage.getItem(e);if(s)try{return JSON.parse(s)}catch{return null}return null},saveSettings:(e,s)=>{localStorage.setItem(e,JSON.stringify(s))},migrateOldSettings:()=>{const s="1.0.0";if(localStorage.getItem("settings-migration-version")!==s)try{const a=localStorage.getItem("flashcards-settings");if(a){const s=JSON.parse(a);e(e=>({...e,flashcardsSettings:s}))}const i=localStorage.getItem("learn-settings");if(i){const s=JSON.parse(i);e(e=>({...e,learnSettings:s}))}localStorage.setItem("settings-migration-version",s),localStorage.removeItem("flashcards-settings"),localStorage.removeItem("learn-settings")}catch(a){}}}),{name:"unified-settings-store",partialize:e=>({flashcardsSettings:e.flashcardsSettings,learnSettings:e.learnSettings,matchSettings:e.matchSettings,testSettings:e.testSettings,presetSelections:e.presetSelections}),onRehydrateStorage:()=>e=>{e?.migrateOldSettings()}})),x=[{id:"simple",label:"Simple",shortLabel:"A → B",description:"First side to second side",tooltip:"Show first side, answer with second side",supportedModes:["flashcards","learn","match"],applyToMode:(e,s)=>"flashcards"===e?{frontSides:[s[0]||"side_a"],backSides:[s[1]||"side_b"]}:"learn"===e?{questionSides:[s[0]||"side_a"],answerSides:[s[1]||"side_b"],questionTypeMix:"auto"}:"match"===e?{frontSides:[s[0]||"side_a"],backSides:[s[1]||"side_b"]}:{}},{id:"reverse",label:"Reverse",shortLabel:"B → A",description:"Second side to first side",tooltip:"Reverse the standard direction for learning",supportedModes:["flashcards","learn"],applyToMode:(e,s)=>"flashcards"===e?{frontSides:[s[1]||"side_b"],backSides:[s[0]||"side_a"]}:"learn"===e?{questionSides:[s[1]||"side_b"],answerSides:[s[0]||"side_a"],questionTypeMix:"auto"}:{}},{id:"comprehensive",label:"Complete",shortLabel:"A → All",description:"First side to all other sides",tooltip:"Show all available information in answers",supportedModes:["flashcards","learn"],applyToMode:(e,s)=>"flashcards"===e?{frontSides:[s[0]||"side_a"],backSides:s.slice(1).length>0?s.slice(1):["side_b"]}:"learn"===e?{questionSides:[s[0]||"side_a"],answerSides:s.slice(1).length>0?s.slice(1):["side_b"],questionTypeMix:"multiple_choice",cardsPerRound:20}:{}},{id:"multi",label:"Multi",shortLabel:"AB → CD",description:"Multiple sides for comprehensive learning",tooltip:"Show multiple pieces of information together",supportedModes:["flashcards","learn"],applyToMode:(e,s)=>{if("flashcards"===e){const e=Math.min(2,Math.floor(s.length/2));return{frontSides:s.slice(0,e).length>0?s.slice(0,e):["side_a"],backSides:s.slice(e).length>0?s.slice(e):["side_b"]}}if("learn"===e){const e=s.filter((e,s)=>s%2==0),a=s.filter((e,s)=>s%2==1);return{questionSides:e.length>0?e:["side_a"],answerSides:a.length>0?a:["side_b"],questionTypeMix:"mixed",randomize:!0}}return{}}},{id:"formal",label:"Formal Test",shortLabel:"Timed",description:"Timed test with scoring",tooltip:"Formal assessment with time limits and scoring",supportedModes:["test"],applyToMode:(e,s)=>"test"===e?{frontSides:[s[0]||"side_a"],backSides:[s[1]||"side_b"],enableTimer:!0,timerSeconds:1800,randomize:!1,progressionMode:"sequential"}:{}},{id:"practice",label:"Practice Test",shortLabel:"Untimed",description:"Untimed practice with immediate feedback",tooltip:"Practice mode with immediate feedback and no time pressure",supportedModes:["test"],applyToMode:(e,s)=>"test"===e?{frontSides:[s[0]||"side_a"],backSides:[s[1]||"side_b"],enableTimer:!1,timerSeconds:null,randomize:!0,progressionMode:"random"}:{}}],g=e=>{if(e.frontSides&&e.backSides){const s=[...e.frontSides,...e.backSides];return[...new Set(s)]}if(e.questionSides&&e.answerSides){const s=[...e.questionSides,...e.answerSides];return[...new Set(s)]}return["side_a","side_b"]},j="_overlay_1vm4n_3",b="_modal_1vm4n_14",v="_header_1vm4n_63",N="_title_1vm4n_72",f="_closeButton_1vm4n_78",S="_content_1vm4n_104",y="_section_1vm4n_119",w="_loadingContainer_1vm4n_127",k="_spinner_1vm4n_136",M="_errorContainer_1vm4n_152",C="_errorMessage_1vm4n_160",T="_footer_1vm4n_170",L="_cancelButton_1vm4n_186",z="_saveButton_1vm4n_187",q="_resetButton_1vm4n_188",I="_container_12c7a_1",R="_title_12c7a_5",D="_presets_12c7a_12",O="_presetButton_12c7a_26",A="_active_12c7a_51",P="_presetLabel_12c7a_62",B=({settings:s,onChange:a,mode:t="flashcards",deck:r})=>{const l=i.useMemo(()=>x.filter(e=>e.supportedModes.includes(t)),[t]),c=i.useMemo(()=>{for(const e of l){const a=e.applyToMode(t,H(s,r));if(W(s,a,t))return e.id}return null},[s,l,t,r]);return 0===l.length?null:e.jsxs("div",{className:I,children:[e.jsx("h3",{className:R,children:"Quick Presets"}),e.jsx("div",{className:D,children:l.map((i,l)=>e.jsx(n.button,{className:`${O} ${c===i.id?A:""}`,onClick:()=>(e=>{const i=x.find(s=>s.id===e);if(!i)return;const n=H(s,r),l=i.applyToMode(t,n);Object.entries(l).forEach(([e,s])=>{a(e,s)})})(i.id),title:i.tooltip,"data-testid":`preset-${i.id}`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*l},whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx("span",{className:P,children:i.label})},i.id))})]})},H=(e,s)=>{if(s&&s.content&&s.content.length>0){const e=s.content[0],a=[];if(void 0!==e.side_a&&null!==e.side_a&&a.push("side_a"),void 0!==e.side_b&&null!==e.side_b&&a.push("side_b"),void 0!==e.side_c&&null!==e.side_c&&a.push("side_c"),void 0!==e.side_d&&null!==e.side_d&&a.push("side_d"),void 0!==e.side_e&&null!==e.side_e&&a.push("side_e"),void 0!==e.side_f&&null!==e.side_f&&a.push("side_f"),a.length>0)return a}return["side_a","side_b"]},W=(e,s,a)=>"flashcards"===a?JSON.stringify(e.frontSides)===JSON.stringify(s.frontSides)&&JSON.stringify(e.backSides)===JSON.stringify(s.backSides):"learn"===a?JSON.stringify(e.questionSides)===JSON.stringify(s.questionSides)&&JSON.stringify(e.answerSides)===JSON.stringify(s.answerSides)&&e.questionTypeMix===s.questionTypeMix:JSON.stringify(e.frontSides)===JSON.stringify(s.frontSides)&&JSON.stringify(e.backSides)===JSON.stringify(s.backSides),F="_container_wngbj_1",J="_title_wngbj_5",$="_description_wngbj_12",G="_sideSelector_wngbj_18",U="_sideOption_wngbj_32",E="_selected_wngbj_53",Q="_sideLabel_wngbj_64",V="_checkmark_wngbj_70",K="_warning_wngbj_86",Y="_error_wngbj_99",X="_selectedInfo_wngbj_112",Z=({settings:s,onChange:a,deck:t,error:r})=>{const l=s.sectionType||"front",c=i.useMemo(()=>{if(!t||!t.content||0===t.content.length)return[];const e=t.content[0],s=[];return e.side_a&&s.push("side_a"),e.side_b&&s.push("side_b"),e.side_c&&s.push("side_c"),e.side_d&&s.push("side_d"),e.side_e&&s.push("side_e"),e.side_f&&s.push("side_f"),s},[t]),d=e=>{const s=t?.metadata?.side_labels?.[e];if(s)return s.charAt(0).toUpperCase()+s.slice(1);const a=e.split("_")[1]?.toUpperCase();return`Side ${a}`},o=i.useMemo(()=>"front"===l?s.frontSides||[]:"back"===l?s.backSides||[]:"question"===l?s.questionSides||[]:"answer"===l&&s.answerSides||[],[s,l]),{title:h,description:m}=(()=>{switch(l){case"front":return{title:"Card Front",description:"Select which sides appear on the front of the card"};case"back":return{title:"Card Back",description:"Select which sides appear on the back of the card"};case"question":return{title:"Question Sides",description:"Select which sides to use for questions"};case"answer":return{title:"Answer Sides",description:"Select which sides to use for answers"};default:return{title:"Side Configuration",description:"Select which sides to use"}}})();return e.jsxs("div",{className:F,children:[e.jsx("h3",{className:J,children:h}),e.jsx("p",{className:$,children:m}),e.jsx("div",{className:G,children:c.map((s,i)=>e.jsxs(n.button,{className:`${U} ${o.includes(s)?E:""}`,onClick:()=>(e=>{const s=[...o],i=s.indexOf(e);i>-1?s.splice(i,1):s.push(e),"front"===l?a("frontSides",s):"back"===l?a("backSides",s):"question"===l?a("questionSides",s):"answer"===l&&a("answerSides",s)})(s),initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.05*i},whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx("span",{className:Q,children:d(s)}),o.includes(s)&&e.jsx("span",{className:V,children:"✓"})]},s))}),0===o.length&&e.jsx("div",{className:K,children:"⚠️ At least one side must be selected"}),r&&e.jsx("div",{className:Y,role:"alert",children:r}),o.length>0&&e.jsxs("div",{className:X,children:[o.length," side",1===o.length?"":"s"," selected"]})]})},ee="_container_bjnsk_1",se="_title_bjnsk_5",ae="_description_bjnsk_12",ie="_progressionOptions_bjnsk_18",ne="_radioOption_bjnsk_25",te="_radioInput_bjnsk_43",re="_radioContent_bjnsk_56",le="_radioLabel_bjnsk_84",ce="_radioDescription_bjnsk_90",de="_infoBox_bjnsk_96",oe="_infoIcon_bjnsk_107",he="_infoText_bjnsk_113",me=({settings:s,onChange:a,mode:i="flashcards"})=>{const n=s.progressionMode||"shuffle",t="flashcards"===i||"learn"===i?[{value:"shuffle",label:"Shuffle",description:"Random order for better retention"},{value:"sequential",label:"Sequential",description:"Content in order as it appears"},{value:"level",label:"By Level",description:"Progressive difficulty based on performance"}]:[{value:"sequential",label:"Sequential",description:"In order"},{value:"random",label:"Random",description:"Randomized order"}];return e.jsxs("div",{className:ee,children:[e.jsx("h3",{className:se,children:"Progression Mode"}),e.jsx("p",{className:ae,children:"Choose how content is presented during your session"}),e.jsx("div",{className:ie,children:t.map(s=>e.jsxs("label",{className:ne,children:[e.jsx("input",{type:"radio",name:"progression",value:s.value,checked:n===s.value,onChange:e=>{return s=e.target.value,void a("progressionMode",s);var s},className:te}),e.jsxs("div",{className:re,children:[e.jsx("span",{className:le,children:s.label}),e.jsx("span",{className:ce,children:s.description})]})]},s.value))}),"shuffle"===n&&e.jsxs("div",{className:de,children:[e.jsx("span",{className:oe,children:"ℹ️"}),e.jsx("span",{className:he,children:"Shuffled content improves long-term retention through varied practice"})]}),"level"===n&&e.jsxs("div",{className:de,children:[e.jsx("span",{className:oe,children:"ℹ️"}),e.jsx("span",{className:he,children:"Progressive difficulty adapts based on your performance"})]})]})},pe="_container_un9ip_1",_e="_title_un9ip_5",ue="_titleIcon_un9ip_15",xe="_settingsGrid_un9ip_19",ge="_settingRow_un9ip_25",je="_labelContainer_un9ip_33",be="_label_un9ip_33",ve="_infoTooltipWrapper_un9ip_48",Ne="_infoIcon_un9ip_54",fe="_infoTooltip_un9ip_48",Se="_numberInput_un9ip_102",ye="_select_un9ip_103",we="_checkboxRow_un9ip_138",ke="_checkboxContainer_un9ip_145",Me="_checkbox_un9ip_138",Ce="_checkboxLabel_un9ip_158",Te="_subsection_un9ip_164",Le="_subsectionTitle_un9ip_170",ze=({text:s})=>e.jsxs("span",{className:ve,children:[e.jsx("span",{className:Ne,children:"ℹ️"}),e.jsx("span",{className:fe,children:s})]}),qe=({settings:s,onChange:a})=>e.jsxs("div",{className:pe,children:[e.jsxs("h3",{className:_e,children:[e.jsx(m,{size:20,className:ue}),"Learning Settings"]}),e.jsxs("div",{className:xe,children:[e.jsxs("label",{className:ge,children:[e.jsx("div",{className:je,children:e.jsxs("span",{className:be,children:["Cards per round",e.jsx(ze,{text:"Number of cards to practice per session"})]})}),e.jsx("input",{type:"number",min:"5",max:"50",value:""===s.cardsPerRound?"":s.cardsPerRound||10,onChange:e=>{const s=e.target.value;if(""===s)a("cardsPerRound","");else{const e=parseInt(s);isNaN(e)||a("cardsPerRound",e)}},onBlur:e=>{const s=""===e.target.value?10:parseInt(e.target.value)||10;a("cardsPerRound",Math.max(5,Math.min(50,s)))},inputMode:"numeric",pattern:"[0-9]*",className:Se})]}),e.jsxs("label",{className:ge,children:[e.jsx("span",{className:be,children:"Question type mix"}),e.jsxs("select",{value:s.questionTypeMix||"auto",onChange:e=>a("questionTypeMix",e.target.value),className:ye,children:[e.jsx("option",{value:"auto",children:"Auto (80% MC, 20% Text)"}),e.jsx("option",{value:"multiple_choice",children:"Multiple Choice Only"}),e.jsx("option",{value:"free_text",children:"Free Text Only"}),e.jsx("option",{value:"mixed",children:"50/50 Mix"})]})]}),e.jsxs("label",{className:ge,children:[e.jsx("div",{className:je,children:e.jsxs("span",{className:be,children:["Scheduling algorithm",e.jsx(ze,{text:"How cards are scheduled for review"})]})}),e.jsxs("select",{value:s.schedulingAlgorithm||"smart_spaced",onChange:e=>a("schedulingAlgorithm",e.target.value),className:ye,children:[e.jsx("option",{value:"smart_spaced",children:"Smart Spaced (Adaptive)"}),e.jsx("option",{value:"leitner_box",children:"Leitner Box System"})]})]}),e.jsx("label",{className:we,children:e.jsxs("div",{className:ke,children:[e.jsx("input",{type:"checkbox",checked:!1!==s.randomize,onChange:e=>a("randomize",e.target.checked),className:Me}),e.jsx("span",{className:Ce,children:"Randomize cards"})]})}),e.jsx("label",{className:we,children:e.jsxs("div",{className:ke,children:[e.jsx("input",{type:"checkbox",checked:!0===s.enableTimer,onChange:e=>a("enableTimer",e.target.checked),className:Me}),e.jsx("span",{className:Ce,children:"Enable timer"})]})}),s.enableTimer&&e.jsxs("label",{className:ge,children:[e.jsx("span",{className:be,children:"Timer seconds"}),e.jsx("input",{type:"number",min:"10",max:"120",value:""===s.timerSeconds?"":s.timerSeconds||30,onChange:e=>{const s=e.target.value;if(""===s)a("timerSeconds","");else{const e=parseInt(s);isNaN(e)||a("timerSeconds",e)}},onBlur:e=>{const s=""===e.target.value?30:parseInt(e.target.value)||30;a("timerSeconds",Math.max(10,Math.min(120,s)))},inputMode:"numeric",pattern:"[0-9]*",className:Se})]})]}),e.jsxs("div",{className:Te,children:[e.jsxs("h4",{className:Le,children:["Progressive Learning",e.jsx(ze,{text:"Control how free text questions follow multiple choice"})]}),e.jsxs("label",{className:ge,children:[e.jsx("span",{className:be,children:"Progressive mode"}),e.jsxs("select",{value:s.progressiveLearning||"spaced",onChange:e=>a("progressiveLearning",e.target.value),className:ye,children:[e.jsx("option",{value:"disabled",children:"Disabled (No follow-ups)"}),e.jsx("option",{value:"immediate",children:"Immediate (Right after MC)"}),e.jsx("option",{value:"spaced",children:"Spaced (With gap)"}),e.jsx("option",{value:"random",children:"Random (30% chance)"})]})]}),"spaced"===s.progressiveLearning&&e.jsxs("label",{className:ge,children:[e.jsx("span",{className:be,children:"Minimum spacing"}),e.jsx("input",{type:"number",min:"1",max:"10",value:""===s.progressiveLearningSpacing?"":s.progressiveLearningSpacing||3,onChange:e=>{const s=e.target.value;if(""===s)a("progressiveLearningSpacing","");else{const e=parseInt(s);isNaN(e)||a("progressiveLearningSpacing",e)}},onBlur:e=>{const s=""===e.target.value?3:parseInt(e.target.value)||3;a("progressiveLearningSpacing",Math.max(1,Math.min(10,s)))},inputMode:"numeric",pattern:"[0-9]*",className:Se})]})]})]}),Ie="_container_3dbw7_1",Re="_title_3dbw7_5",De="_titleIcon_3dbw7_15",Oe="_resetBox_3dbw7_20",Ae="_resetDescription_3dbw7_27",Pe="_warningBox_3dbw7_34",Be="_warningIcon_3dbw7_45",He="_warningText_3dbw7_51",We="_resetActions_3dbw7_57",Fe="_resetButton_3dbw7_63",Je="_confirmRow_3dbw7_82",$e="_confirmText_3dbw7_88",Ge="_confirmButtons_3dbw7_94",Ue="_confirmButton_3dbw7_94",Ee="_cancelButton_3dbw7_100",Qe="_settingsGrid_3dbw7_131",Ve="_settingRow_3dbw7_137",Ke="_labelContainer_3dbw7_144",Ye="_label_3dbw7_144",Xe="_infoIcon_3dbw7_159",Ze="_numberInput_3dbw7_169",es="_checkboxRow_3dbw7_193",ss="_checkboxContainer_3dbw7_199",as="_checkbox_3dbw7_193",is="_checkboxLabel_3dbw7_212",ns="_infoBox_3dbw7_222",ts="_masteredInfo_3dbw7_233",rs="_masteredStatus_3dbw7_244",ls="_statusIcon_3dbw7_258",cs="_masteredSettings_3dbw7_262",ds=({text:s})=>e.jsx("span",{className:Xe,title:s,children:"ℹ️"}),os=({settings:s,onChange:a,deck:n,mode:r="flashcards",onResetMastery:c})=>{const[d,o]=i.useState(!1),{getMasteredCardsForDeck:h,shuffleMasteredCardsBack:m,toggleShuffleMastered:p}=t(),_=n?h(n.id).length:0;if("deck"===r){const s=()=>{d?(c&&c(),o(!1)):o(!0)},a=()=>o(!1);return e.jsxs("div",{className:Ie,children:[e.jsxs("h3",{className:Re,children:[e.jsx(l,{size:20,className:De}),"Mastery Management"]}),e.jsxs("div",{className:Oe,children:[e.jsx("p",{className:Ae,children:"Reset the mastered card list for this deck. This will clear all mastery progress and allow you to restart learning from scratch."}),_>0&&e.jsxs("div",{className:ts,children:["Currently, ",_," card",1===_?" is":"s are"," mastered in this deck."]}),e.jsxs("div",{className:Pe,children:[e.jsx("span",{className:Be,children:"⚠️"}),e.jsx("span",{className:He,children:"This action cannot be undone. All mastery progress will be permanently lost."})]}),e.jsx("div",{className:We,children:d?e.jsxs("div",{className:Je,children:[e.jsx("span",{className:$e,children:"Are you sure you want to reset all mastery progress?"}),e.jsxs("div",{className:Ge,children:[e.jsx("button",{className:Ue,onClick:s,children:"Yes, Reset"}),e.jsx("button",{className:Ee,onClick:a,children:"Cancel"})]})]}):e.jsx("button",{className:Fe,onClick:s,children:"Reset Mastered Cards"})})]})]})}return"learn"===r?e.jsxs("div",{className:Ie,children:[e.jsxs("h3",{className:Re,children:[e.jsx(l,{size:20,className:De}),"Mastery Settings"]}),e.jsxs("div",{className:Qe,children:[e.jsxs("label",{className:Ve,children:[e.jsx("div",{className:Ke,children:e.jsxs("span",{className:Ye,children:["Mastery threshold",e.jsx(ds,{text:"Correct answers needed to master a card"})]})}),e.jsx("input",{type:"number",min:"1",max:"10",value:""===s.masteryThreshold?"":s.masteryThreshold||3,onChange:e=>{const s=e.target.value;if(""===s)a("masteryThreshold","");else{const e=parseInt(s);isNaN(e)||a("masteryThreshold",e)}},onBlur:e=>{const s=""===e.target.value?3:parseInt(e.target.value)||3;a("masteryThreshold",Math.max(1,Math.min(10,s)))},inputMode:"numeric",pattern:"[0-9]*",className:Ze})]}),e.jsx("label",{className:es,children:e.jsxs("div",{className:ss,children:[e.jsx("input",{type:"checkbox",checked:m,onChange:()=>p(),className:as}),e.jsxs("span",{className:is,children:["Shuffle mastered cards back",e.jsx(ds,{text:"Periodically include mastered cards in learning sessions for review"})]})]})}),e.jsxs("div",{className:ns,children:[e.jsx("strong",{children:"How mastery works:"})," Cards are marked as mastered after"," ",s.masteryThreshold||3," correct answers. Once mastered, cards can be managed from the deck view."]}),_>0&&e.jsxs("div",{className:rs,children:[e.jsx(l,{size:16,className:ls}),e.jsxs("span",{children:[_," card",1===_?"":"s"," mastered in this deck"]})]})]})]}):e.jsxs("div",{className:Ie,children:[e.jsx("h3",{className:Re,children:"Mastered Cards"}),e.jsxs("div",{className:cs,children:[e.jsx("label",{className:es,children:e.jsxs("div",{className:ss,children:[e.jsx("input",{type:"checkbox",checked:!1!==s.includeMastered,onChange:e=>a("includeMastered",e.target.checked),className:as}),e.jsx("span",{className:is,children:"Include mastered cards"})]})}),_>0&&e.jsxs("div",{className:ts,children:[_," card",1===_?" is":"s are"," currently mastered"]}),_>0&&!s.includeMastered&&e.jsxs("div",{className:Pe,children:[e.jsx("span",{className:Be,children:"ℹ️"}),e.jsxs("span",{className:He,children:[_," mastered card",1===_?"":"s"," will be excluded from this session"]})]})]})]})},hs="_container_6e729_1",ms="_title_6e729_5",ps="_titleIcon_6e729_15",_s="_infoBox_6e729_19",us="_infoRow_6e729_29",xs="_infoLabel_6e729_43",gs="_infoValue_6e729_51",js="_tags_6e729_60",bs="_tag_6e729_60",vs="_sideLabels_6e729_78",Ns="_sideLabel_6e729_78",fs="_sideName_6e729_92",Ss="_sideValue_6e729_97",ys=({deck:s})=>s?e.jsxs("div",{className:hs,children:[e.jsxs("h3",{className:ms,children:[e.jsx(p,{size:20,className:ps}),"Deck Information"]}),e.jsxs("div",{className:_s,children:[e.jsxs("div",{className:us,children:[e.jsx("span",{className:xs,children:"Deck Name:"}),e.jsx("span",{className:gs,children:s.metadata.deck_name})]}),e.jsxs("div",{className:us,children:[e.jsx("span",{className:xs,children:"Total Cards:"}),e.jsx("span",{className:gs,children:s.content.length})]}),s.metadata.description&&e.jsxs("div",{className:us,children:[e.jsx("span",{className:xs,children:"Description:"}),e.jsx("span",{className:gs,children:s.metadata.description})]}),s.metadata.category&&e.jsxs("div",{className:us,children:[e.jsx("span",{className:xs,children:"Category:"}),e.jsx("span",{className:gs,children:s.metadata.category})]}),s.metadata.difficulty&&e.jsxs("div",{className:us,children:[e.jsx("span",{className:xs,children:"Difficulty:"}),e.jsx("span",{className:gs,children:s.metadata.difficulty.charAt(0).toUpperCase()+s.metadata.difficulty.slice(1).replace("_"," - ")})]}),s.metadata.tags&&s.metadata.tags.length>0&&e.jsxs("div",{className:us,children:[e.jsx("span",{className:xs,children:"Tags:"}),e.jsx("div",{className:js,children:s.metadata.tags.map((s,a)=>e.jsx("span",{className:bs,children:s},a))})]}),s.metadata.available_sides&&e.jsxs("div",{className:us,children:[e.jsx("span",{className:xs,children:"Available Sides:"}),e.jsxs("span",{className:gs,children:[s.metadata.available_sides," sides per card"]})]}),s.metadata.side_labels&&e.jsxs("div",{className:us,children:[e.jsx("span",{className:xs,children:"Side Labels:"}),e.jsx("div",{className:vs,children:Object.entries(s.metadata.side_labels).map(([s,a])=>e.jsxs("div",{className:Ns,children:[e.jsxs("span",{className:fs,children:[s.replace("_"," ").toUpperCase(),":"]}),e.jsx("span",{className:Ss,children:a})]},s))})]}),s.metadata.version&&e.jsxs("div",{className:us,children:[e.jsx("span",{className:xs,children:"Version:"}),e.jsx("span",{className:gs,children:s.metadata.version})]}),s.metadata.last_updated&&e.jsxs("div",{className:us,children:[e.jsx("span",{className:xs,children:"Last Updated:"}),e.jsx("span",{className:gs,children:new Date(s.metadata.last_updated).toLocaleDateString()})]})]})]}):null,ws="_container_brv4s_3",ks="_title_brv4s_8",Ms="_titleIcon_brv4s_18",Cs="_settingsGrid_brv4s_23",Ts="_settingSection_brv4s_30",Ls="_sectionLabel_brv4s_40",zs="_sectionIcon_brv4s_50",qs="_infoTooltipWrapper_brv4s_56",Is="_infoIcon_brv4s_62",Rs="_infoTooltip_brv4s_56",Ds="_gridPresets_brv4s_91",Os="_gridPresetButton_brv4s_98",As="_active_brv4s_117",Ps="_presetLabel_brv4s_126",Bs="_presetInfo_brv4s_132",Hs="_customGridSize_brv4s_138",Ws="_customLabel_brv4s_148",Fs="_gridInputs_brv4s_154",Js="_gridInput_brv4s_154",$s="_gridMultiplier_brv4s_173",Gs="_numberInput_brv4s_181",Us="_matchTypeOptions_brv4s_199",Es="_radioOption_brv4s_205",Qs="_radioInput_brv4s_222",Vs="_radioContent_brv4s_243",Ks="_radioLabel_brv4s_250",Ys="_radioDescription_brv4s_256",Xs="_cardSidesConfig_brv4s_262",Zs="_cardSideRow_brv4s_268",ea="_sideSelection_brv4s_279",sa="_sideCount_brv4s_280",aa="_sideLabel_brv4s_285",ia="_select_brv4s_294",na="_timerOptions_brv4s_311",ta="_checkboxRow_brv4s_319",ra="_checkboxContainer_brv4s_333",la="_checkbox_brv4s_319",ca="_checkboxLabel_brv4s_347",da="_settingRow_brv4s_357",oa="_label_brv4s_366",ha="_settingsSummary_brv4s_380",ma="_summaryTitle_brv4s_388",pa="_summaryGrid_brv4s_395",_a="_summaryItem_brv4s_401",ua="_summaryLabel_brv4s_410",xa="_summaryValue_brv4s_416",ga=({text:s})=>e.jsxs("span",{className:qs,children:[e.jsx("span",{className:Is,children:"ℹ️"}),e.jsx("span",{className:Rs,children:s})]}),ja=[{label:"Small (2×3)",rows:2,cols:3,cards:6},{label:"Medium (3×4)",rows:3,cols:4,cards:12},{label:"Large (4×4)",rows:4,cols:4,cards:16},{label:"Extra Large (4×5)",rows:4,cols:5,cards:20}],ba=({settings:s,onChange:a,deck:i})=>{const n=s,t=i?.metadata?.available_sides||2,r=[];for(let e=0;e<Math.min(t,6);e++){const s=["side_a","side_b","side_c","side_d","side_e","side_f"];r.push(s[e])}const l=e=>{const s=i?.metadata?.side_labels?.[e];if(s)return s.charAt(0).toUpperCase()+s.slice(1);return{side_a:"Front",side_b:"Back",side_c:"Notes",side_d:"Side D",side_e:"Side E",side_f:"Side F"}[e]||e.replace("side_","Side ").toUpperCase()},c=(e,s)=>{a("gridSize",{rows:e,cols:s})},d=e=>{a("matchType",e);const s=n.gridSize.rows*n.gridSize.cols,i=Math.floor(s/2);let t;switch(e){case"two_way":t=[{sides:["side_a"],label:l("side_a"),count:i},{sides:["side_b"],label:l("side_b"),count:i}];break;case"three_way":const e=Math.floor(s/3);t=[{sides:["side_a"],label:l("side_a"),count:e},{sides:["side_b"],label:l("side_b"),count:e},{sides:["side_c"],label:l("side_c"),count:e}];break;default:t=n.cardSides}a("cardSides",t)};return e.jsxs("div",{className:ws,children:[e.jsxs("h3",{className:ks,children:[e.jsx(h,{size:20,className:Ms}),"Match Game Settings"]}),e.jsxs("div",{className:Cs,children:[e.jsxs("div",{className:Ts,children:[e.jsxs("label",{className:Ls,children:["Grid Size",e.jsx(ga,{text:"Choose how many cards appear in the match grid"})]}),e.jsx("div",{className:Ds,children:ja.map(s=>e.jsxs("button",{type:"button",className:`${Os} ${n.gridSize.rows===s.rows&&n.gridSize.cols===s.cols?As:""}`,onClick:()=>c(s.rows,s.cols),children:[e.jsx("span",{className:Ps,children:s.label}),e.jsxs("span",{className:Bs,children:[s.cards," cards"]})]},`${s.rows}x${s.cols}`))}),e.jsxs("div",{className:Hs,children:[e.jsx("span",{className:Ws,children:"Custom Size:"}),e.jsxs("div",{className:Fs,children:[e.jsxs("label",{className:Js,children:[e.jsx("span",{children:"Rows"}),e.jsx("input",{type:"number",min:"2",max:"6",value:n.gridSize.rows,onChange:e=>{const s=parseInt(e.target.value)||2;c(s,n.gridSize.cols)},className:Gs})]}),e.jsx("span",{className:$s,children:"×"}),e.jsxs("label",{className:Js,children:[e.jsx("span",{children:"Cols"}),e.jsx("input",{type:"number",min:"2",max:"6",value:n.gridSize.cols,onChange:e=>{const s=parseInt(e.target.value)||2;c(n.gridSize.rows,s)},className:Gs})]})]})]})]}),e.jsxs("div",{className:Ts,children:[e.jsxs("label",{className:Ls,children:["Match Type",e.jsx(ga,{text:"How cards should match together"})]}),e.jsxs("div",{className:Us,children:[e.jsxs("label",{className:Es,children:[e.jsx("input",{type:"radio",name:"matchType",value:"two_way",checked:"two_way"===n.matchType,onChange:()=>d("two_way"),className:Qs}),e.jsxs("div",{className:Vs,children:[e.jsx("span",{className:Ks,children:"Two-Way Matching"}),e.jsxs("span",{className:Ys,children:["Match ",l("side_a")," ↔ ",l("side_b")]})]})]}),e.jsxs("label",{className:Es,children:[e.jsx("input",{type:"radio",name:"matchType",value:"three_way",checked:"three_way"===n.matchType,onChange:()=>d("three_way"),className:Qs,disabled:r.length<3}),e.jsxs("div",{className:Vs,children:[e.jsx("span",{className:Ks,children:"Three-Way Matching"}),e.jsx("span",{className:Ys,children:r.length<3?"Requires 3+ sides":`Match ${l("side_a")} ↔ ${l("side_b")} ↔ ${l("side_c")}`})]})]}),e.jsxs("label",{className:Es,children:[e.jsx("input",{type:"radio",name:"matchType",value:"custom",checked:"custom"===n.matchType,onChange:()=>d("custom"),className:Qs}),e.jsxs("div",{className:Vs,children:[e.jsx("span",{className:Ks,children:"Custom Configuration"}),e.jsx("span",{className:Ys,children:"Configure manually below"})]})]})]})]}),("custom"===n.matchType||n.cardSides.length>0)&&e.jsxs("div",{className:Ts,children:[e.jsxs("label",{className:Ls,children:["Card Sides to Display",e.jsx(ga,{text:"Configure which sides appear and how many cards show each side"})]}),e.jsx("div",{className:Xs,children:n.cardSides.map((s,i)=>e.jsxs("div",{className:Zs,children:[e.jsx("div",{className:ea,children:e.jsxs("label",{className:aa,children:["Side to show:",e.jsx("select",{value:s.sides[0]||"side_a",onChange:e=>{const t=[...n.cardSides];t[i]={...s,sides:[e.target.value],label:l(e.target.value)},a("cardSides",t)},className:ia,children:r.map(s=>e.jsx("option",{value:s,children:l(s)},s))})]})}),e.jsx("div",{className:sa,children:e.jsxs("label",{className:aa,children:["Card count:",e.jsx("input",{type:"number",min:"1",max:n.gridSize.rows*n.gridSize.cols-1,value:s.count,onChange:e=>{const t=[...n.cardSides];t[i]={...s,count:parseInt(e.target.value)||1},a("cardSides",t)},className:Gs})]})})]},i))})]}),e.jsxs("div",{className:Ts,children:[e.jsxs("label",{className:Ls,children:[e.jsx(m,{size:18,className:zs}),"Timer Settings"]}),e.jsx("label",{className:ta,children:e.jsxs("div",{className:ra,children:[e.jsx("input",{type:"checkbox",checked:!0===n.enableTimer,onChange:e=>a("enableTimer",e.target.checked),className:la}),e.jsx("span",{className:ca,children:"Enable timer"})]})}),n.enableTimer&&e.jsxs("div",{className:na,children:[e.jsxs("label",{className:Es,children:[e.jsx("input",{type:"radio",name:"timerMode",checked:0===n.timerSeconds,onChange:()=>a("timerSeconds",0),className:Qs}),e.jsxs("div",{className:Vs,children:[e.jsx("span",{className:Ks,children:"Count-up Timer"}),e.jsx("span",{className:Ys,children:"Track your completion time"})]})]}),e.jsxs("label",{className:Es,children:[e.jsx("input",{type:"radio",name:"timerMode",checked:n.timerSeconds>0,onChange:()=>a("timerSeconds",120),className:Qs}),e.jsxs("div",{className:Vs,children:[e.jsx("span",{className:Ks,children:"Countdown Timer"}),e.jsx("span",{className:Ys,children:"Race against time"})]})]}),n.timerSeconds>0&&e.jsxs("label",{className:da,children:[e.jsx("span",{className:oa,children:"Time limit (seconds)"}),e.jsx("input",{type:"number",min:"30",max:"600",value:n.timerSeconds,onChange:e=>{const s=parseInt(e.target.value)||120;a("timerSeconds",Math.max(30,Math.min(600,s)))},className:Gs})]})]})]}),e.jsxs("div",{className:Ts,children:[e.jsx("label",{className:Ls,children:"Additional Options"}),e.jsx("label",{className:ta,children:e.jsxs("div",{className:ra,children:[e.jsx("input",{type:"checkbox",checked:!0===n.includeMastered,onChange:e=>a("includeMastered",e.target.checked),className:la}),e.jsxs("span",{className:ca,children:["Include mastered cards",e.jsx(ga,{text:"Include cards you've already mastered in the game"})]})]})}),e.jsx("label",{className:ta,children:e.jsxs("div",{className:ra,children:[e.jsx("input",{type:"checkbox",checked:!0===n.enableAudio,onChange:e=>a("enableAudio",e.target.checked),className:la}),e.jsxs("span",{className:ca,children:["Enable sound effects",e.jsx(ga,{text:"Play sounds for matches and game completion"})]})]})})]})]}),e.jsxs("div",{className:ha,children:[e.jsx("h4",{className:ma,children:"Current Configuration"}),e.jsxs("div",{className:pa,children:[e.jsxs("div",{className:_a,children:[e.jsx("span",{className:ua,children:"Grid:"}),e.jsxs("span",{className:xa,children:[n.gridSize.rows,"×",n.gridSize.cols,"(",n.gridSize.rows*n.gridSize.cols," cards)"]})]}),e.jsxs("div",{className:_a,children:[e.jsx("span",{className:ua,children:"Match Type:"}),e.jsxs("span",{className:xa,children:["two_way"===n.matchType&&"Two-Way","three_way"===n.matchType&&"Three-Way","custom"===n.matchType&&"Custom"]})]}),e.jsxs("div",{className:_a,children:[e.jsx("span",{className:ua,children:"Timer:"}),e.jsx("span",{className:xa,children:n.enableTimer?0===n.timerSeconds?"Count-up":`${n.timerSeconds}s countdown`:"Disabled"})]})]})]})]})},va="_settingsSection_1ylhz_1",Na="_sectionTitle_1ylhz_7",fa="_settingGroup_1ylhz_14",Sa="_settingLabel_1ylhz_20",ya="_settingHint_1ylhz_29",wa="_radioGroup_1ylhz_35",ka="_radioOption_1ylhz_49",Ma="_selectGroup_1ylhz_73",Ca="_selectWrapper_1ylhz_87",Ta="_selectLabel_1ylhz_94",La="_select_1ylhz_73",za="_directionArrow_1ylhz_122",qa="_numberInput_1ylhz_128",Ia="_checkboxLabel_1ylhz_149",Ra=({settings:s,onChange:a,deck:i})=>{const n=s,t=i?.reading?.sides||{a:"Characters",b:"Pinyin",c:"English"},r=Object.entries(t).filter(([e,s])=>s).map(([e,s])=>({value:e,label:s})),l=(e,s)=>{const i={...n.translationDirection};i[e]=s,a("translationDirection",i)};return e.jsxs("div",{className:va,children:[e.jsx("h3",{className:Na,children:"Read Mode Settings"}),e.jsxs("div",{className:fa,children:[e.jsxs("label",{className:Sa,children:["Answer Type",e.jsx("span",{className:ya,children:"How you want to practice translation"})]}),e.jsxs("div",{className:wa,children:[e.jsxs("label",{className:ka,children:[e.jsx("input",{type:"radio",name:"answerType",value:"free_text",checked:"free_text"===n.answerType,onChange:e=>a("answerType",e.target.value)}),e.jsx("span",{children:"Free Text"})]}),e.jsxs("label",{className:ka,children:[e.jsx("input",{type:"radio",name:"answerType",value:"multiple_choice",checked:"multiple_choice"===n.answerType,onChange:e=>a("answerType",e.target.value)}),e.jsx("span",{children:"Multiple Choice"})]})]})]}),e.jsxs("div",{className:fa,children:[e.jsxs("label",{className:Sa,children:["Check Mode",e.jsx("span",{className:ya,children:"When to check your answers"})]}),e.jsxs("div",{className:wa,children:[e.jsxs("label",{className:ka,children:[e.jsx("input",{type:"radio",name:"checkMode",value:"live",checked:"live"===n.checkMode,onChange:e=>a("checkMode",e.target.value)}),e.jsx("span",{children:"Live (check as you type)"})]}),e.jsxs("label",{className:ka,children:[e.jsx("input",{type:"radio",name:"checkMode",value:"wait",checked:"wait"===n.checkMode,onChange:e=>a("checkMode",e.target.value)}),e.jsx("span",{children:"Wait (check on submit)"})]})]})]}),e.jsxs("div",{className:fa,children:[e.jsxs("label",{className:Sa,children:["Translation Mode",e.jsx("span",{className:ya,children:"How to practice translation"})]}),e.jsxs("div",{className:wa,children:[e.jsxs("label",{className:ka,children:[e.jsx("input",{type:"radio",name:"translationMode",value:"sentence",checked:"sentence"===n.translationMode,onChange:e=>a("translationMode",e.target.value)}),e.jsx("span",{children:"Full Sentence (Recommended)"})]}),e.jsxs("label",{className:ka,children:[e.jsx("input",{type:"radio",name:"translationMode",value:"token",checked:"token"===n.translationMode,onChange:e=>a("translationMode",e.target.value)}),e.jsx("span",{children:"Word/Character by Word"})]})]})]}),e.jsxs("div",{className:fa,children:[e.jsxs("label",{className:Sa,children:["Translation Direction",e.jsx("span",{className:ya,children:"What to translate from and to"})]}),e.jsxs("div",{className:Ma,children:[e.jsxs("div",{className:Ca,children:[e.jsx("label",{className:Ta,children:"From:"}),e.jsx("select",{value:n.translationDirection.from,onChange:e=>l("from",e.target.value),className:La,children:r.map(s=>e.jsx("option",{value:s.value,disabled:s.value===n.translationDirection.to,children:s.label},s.value))})]}),e.jsx("span",{className:za,children:"→"}),e.jsxs("div",{className:Ca,children:[e.jsx("label",{className:Ta,children:"To:"}),e.jsx("select",{value:n.translationDirection.to,onChange:e=>l("to",e.target.value),className:La,children:r.map(s=>e.jsx("option",{value:s.value,disabled:s.value===n.translationDirection.from,children:s.label},s.value))})]})]})]}),"multiple_choice"===n.answerType&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:fa,children:[e.jsxs("label",{className:Sa,children:["Number of Options",e.jsx("span",{className:ya,children:"How many choices to show"})]}),e.jsx("input",{type:"number",min:"2",max:"8",value:n.optionsCount||4,onChange:e=>a("optionsCount",parseInt(e.target.value)),className:qa})]}),e.jsxs("div",{className:fa,children:[e.jsxs("label",{className:Sa,children:["Difficulty",e.jsx("span",{className:ya,children:"Controls distractor pool"})]}),e.jsxs("div",{className:wa,children:[e.jsxs("label",{className:ka,children:[e.jsx("input",{type:"radio",name:"difficulty",value:"easy",checked:"easy"===n.multipleChoiceDifficulty,onChange:e=>a("multipleChoiceDifficulty",e.target.value)}),e.jsx("span",{children:"Easy (same line)"})]}),e.jsxs("label",{className:ka,children:[e.jsx("input",{type:"radio",name:"difficulty",value:"medium",checked:"medium"===n.multipleChoiceDifficulty,onChange:e=>a("multipleChoiceDifficulty",e.target.value)}),e.jsx("span",{children:"Medium (same dialogue)"})]}),e.jsxs("label",{className:ka,children:[e.jsx("input",{type:"radio",name:"difficulty",value:"hard",checked:"hard"===n.multipleChoiceDifficulty,onChange:e=>a("multipleChoiceDifficulty",e.target.value)}),e.jsx("span",{children:"Hard (any dialogue)"})]})]})]})]}),"sentence"===n.translationMode&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:fa,children:[e.jsxs("label",{className:Sa,children:["Accuracy Threshold",e.jsx("span",{className:ya,children:"Minimum similarity % for partial credit"})]}),e.jsx("input",{type:"number",min:"50",max:"100",step:"5",value:n.accuracyThreshold||70,onChange:e=>a("accuracyThreshold",parseInt(e.target.value)),className:qa})]}),e.jsx("div",{className:fa,children:e.jsxs("label",{className:Ia,children:[e.jsx("input",{type:"checkbox",checked:!1!==n.showWordHints,onChange:e=>a("showWordHints",e.target.checked)}),e.jsx("span",{children:"Show Word Hints on Hover/Tap"})]})})]}),e.jsx("div",{className:fa,children:e.jsxs("label",{className:Ia,children:[e.jsx("input",{type:"checkbox",checked:n.showPinyinDefault,onChange:e=>a("showPinyinDefault",e.target.checked)}),e.jsx("span",{children:"Show Pinyin by Default"})]})}),e.jsxs("div",{className:fa,children:[e.jsxs("label",{className:Sa,children:["Token Unit",e.jsx("span",{className:ya,children:"How to split text for practice"})]}),e.jsxs("div",{className:wa,children:[e.jsxs("label",{className:ka,children:[e.jsx("input",{type:"radio",name:"unit",value:"character",checked:"character"===n.unit,onChange:e=>a("unit",e.target.value)}),e.jsx("span",{children:"Character"})]}),e.jsxs("label",{className:ka,children:[e.jsx("input",{type:"radio",name:"unit",value:"word",checked:"word"===n.unit,onChange:e=>a("unit",e.target.value)}),e.jsx("span",{children:"Word"})]})]})]})]})},Da=i.memo(({visible:s,onClose:a,deck:t,mode:l,settings:c,onUpdateSettings:d,onResetMastery:o})=>{const[h]=i.useState(!1),[m,p]=i.useState(!1),[_,I]=i.useState({}),R=i.useMemo(()=>(e=>({mode:e,availableSections:{flashcards:[{id:"quick_presets",title:"Quick Presets",visible:!0,component:B,order:1},{id:"front_sides",title:"Card Front",description:"Select which sides appear on the front of the card",visible:!0,required:!0,component:Z,order:2},{id:"back_sides",title:"Card Back",description:"Select which sides appear on the back of the card",visible:!0,required:!0,component:Z,order:3},{id:"progression",title:"Card Progression",description:"Choose how cards are presented during your session",visible:!0,component:me,order:4},{id:"mastered_cards",title:"Mastered Cards",visible:!0,component:os,order:5}],learn:[{id:"quick_presets",title:"Quick Presets",visible:!0,component:B,order:1},{id:"question_sides",title:"Question Sides",description:"Select which sides to use for questions",visible:!0,required:!0,component:Z,order:2},{id:"answer_sides",title:"Answer Sides",description:"Select which sides to use for answers",visible:!0,required:!0,component:Z,order:3},{id:"learning_settings",title:"Learning Settings",visible:!0,component:qe,order:4},{id:"progression",title:"Progression Mode",visible:!0,component:me,order:5},{id:"mastery_settings",title:"Mastery Settings",visible:!0,component:os,order:6}],deck:[{id:"deck_information",title:"Deck Information",visible:!0,component:ys,order:1},{id:"mastery_management",title:"Mastery Management",visible:!0,component:os,order:2}],match:[{id:"quick_presets",title:"Quick Presets",visible:!0,component:B,order:1},{id:"match_settings",title:"Match Game Settings",description:"Configure grid size, match type, and game options",visible:!0,required:!0,component:ba,order:2},{id:"mastery_settings",title:"Mastery Settings",description:"Control which cards appear in the game",visible:!0,component:os,order:3}],test:[{id:"quick_presets",title:"Quick Presets",visible:!0,component:B,order:1},{id:"test_configuration",title:"Test Configuration",visible:!1,component:B,order:2}],read:[{id:"read_settings",title:"Read Mode Settings",description:"Configure translation direction and answer options",visible:!0,required:!0,component:Ra,order:1}]}[e]||[],presets:[],persistenceKey:`unified-settings-${e}`,validationRules:{flashcards:[{field:"frontSides",validator:e=>e&&e.length>0,errorMessage:"At least one front side is required"},{field:"backSides",validator:e=>e&&e.length>0,errorMessage:"At least one back side is required"}],learn:[{field:"questionSides",validator:e=>e&&e.length>0,errorMessage:"At least one question side is required"},{field:"answerSides",validator:e=>e&&e.length>0,errorMessage:"At least one answer side is required"},{field:"duplicateSides",validator:(e,s)=>0===s.questionSides.filter(e=>s.answerSides.includes(e)).length,errorMessage:"Same side cannot be both question and answer"},{field:"cardsPerRound",validator:e=>e>=5&&e<=50,errorMessage:"Cards per round must be between 5 and 50"}],deck:[],match:[{field:"gridSize",validator:e=>e&&e.rows>=2&&e.cols>=2&&e.rows*e.cols>=6,errorMessage:"Grid must be at least 2x2 with minimum 6 cards"},{field:"cardSides",validator:e=>e&&e.length>=2&&e.every(e=>e.count>0),errorMessage:"At least 2 card side configurations required with positive counts"},{field:"timerSeconds",validator:(e,s)=>!s.enableTimer||e>=0,errorMessage:"Timer seconds must be 0 or positive when timer is enabled"}],test:[],read:[{field:"translationDirection",validator:e=>e&&e.from&&e.to&&e.from!==e.to,errorMessage:"Translation direction must have different from and to sides"},{field:"optionsCount",validator:e=>!e||e>=2,errorMessage:"Options count must be at least 2"}]}[e]||[]}))(l),[l,t]),{localSettings:D,updateSetting:O,handleSave:A,validate:P}=((e,s,a)=>{const[n,t]=i.useState(e),{saveSettings:r,getSettings:l}=u();i.useEffect(()=>{(async()=>{const a=l(s.persistenceKey);t(a||e)})()},[s.persistenceKey,e]);const c=i.useCallback((e,s)=>{t(a=>({...a,[e]:s}))},[]),d=i.useCallback(e=>{const a=x.find(s=>s.id===e);if(!a||!a.supportedModes.includes(s.mode))return;const i=g(n),r=a.applyToMode(s.mode,i);t(e=>({...e,...r}))},[s.mode,n]),o=i.useCallback(e=>{const a={};return s.validationRules.forEach(s=>{s.validator(e[s.field],e)||(a[s.field]=s.errorMessage)}),a},[s.validationRules]),h=i.useCallback(async()=>{const e=o(n);if(Object.keys(e).length>0)throw new Error("Validation failed");r(s.persistenceKey,n),a(n)},[n,o,r,s.persistenceKey,a]),m=i.useMemo(()=>x.filter(e=>e.supportedModes.includes(s.mode)),[s.mode]);return{localSettings:n,updateSetting:c,applyPreset:d,handleSave:h,validate:o,applicablePresets:m}})(c,R,d);i.useEffect(()=>{s||(I({}),p(!1))},[s]);return t||"deck"===l?e.jsx(r,{children:s&&e.jsxs(e.Fragment,{children:[e.jsx(n.div,{className:j,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:a}),e.jsxs(n.div,{className:b,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{type:"spring",stiffness:300,damping:30},children:[e.jsxs("header",{className:v,children:[e.jsx("h2",{className:N,children:{flashcards:"Flashcard Settings",learn:"Learn Mode Settings",deck:"Deck Settings",match:"Match Settings",test:"Test Settings",read:"Read Settings"}[l]||"Settings"}),e.jsx("button",{className:f,onClick:a,"aria-label":"Close settings",children:"✕"})]}),e.jsx("div",{className:S,children:h?e.jsxs("div",{className:w,children:[e.jsx("div",{className:k,"data-testid":"loading-spinner"}),e.jsx("span",{children:"Loading settings..."})]}):e.jsxs(e.Fragment,{children:[R.availableSections.filter(e=>e.visible).sort((e,s)=>e.order-s.order).map(s=>{const a=s.component,i=_[s.id]||"",r=Oa(s.id,D);return e.jsx(n.section,{className:y,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*s.order,type:"spring",stiffness:100},children:e.jsx(a,{settings:r,onChange:O,deck:t,mode:l,error:i})},s.id)}),Object.keys(_).length>0&&e.jsx(n.div,{className:M,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},role:"alert",children:Object.values(_).map((s,a)=>e.jsx("div",{className:C,children:s},a))})]})}),e.jsxs("footer",{className:T,children:[e.jsx("button",{className:L,onClick:a,children:"Cancel"}),"deck"===l&&o?e.jsx("button",{className:q,onClick:o,children:"Reset Mastery"}):e.jsx("button",{className:z,onClick:async()=>{const e=P(D);if(Object.keys(e).length>0)I(e);else{p(!0);try{await A(),a()}catch(s){I({save:"Failed to save settings. Please try again."})}finally{p(!1)}}},disabled:m||Object.keys(_).length>0,children:m?"Saving...":"Save Settings"})]})]})]})}):null}),Oa=(e,s)=>"quick_presets"===e?s:"front_sides"===e||"back_sides"===e?{...s,sectionType:"front_sides"===e?"front":"back"}:"question_sides"===e||"answer_sides"===e?{...s,sectionType:"question_sides"===e?"question":"answer"}:s;Da.displayName="UnifiedSettings";export{c as B,d as C,h as D,o as R,l as T,Da as U,u};
