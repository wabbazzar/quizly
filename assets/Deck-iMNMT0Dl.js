import{r as e,j as a,m as s,a as t,c as i,u as d,b as n}from"./index-K5uqA-3n.js";import{u as r}from"./cardMasteryStore-z-5vmz49.js";import{P as c}from"./PageHeader-DPZ1jwk0.js";import{B as o,T as l,D as m,R as _,C as h,u as x,U as u}from"./UnifiedSettings-HzgFl0jR.js";import{F as j,L as p,M as g,R as b}from"./ModeIcons-DELIAF_0.js";import"./SettingsIcon-BSlFCqwD.js";const k=e.memo(({deck:e,onBackClick:s,onSettingsClick:t})=>{if(!e||!e.content||!e.metadata)return null;const i=`${e.content.length} cards${e.metadata.difficulty?` • ${e.metadata.difficulty.replace("_"," ")}`:""}${e.metadata.tags&&e.metadata.tags.length>0?` • ${e.metadata.tags.slice(0,2).join(", ")}`:""}`;return a.jsx(c,{title:e.metadata.deck_name,subtitle:e.metadata.deck_subtitle||e.metadata.description||i,onBackClick:s,backLabel:"Home",onSettingsClick:t,showSettings:!0})});k.displayName="DeckHeader";const v={modesSection:"_modesSection_uc8zb_1",sectionTitle:"_sectionTitle_uc8zb_6",modesGrid:"_modesGrid_uc8zb_14",modeCard:"_modeCard_uc8zb_22",primary:"_primary_uc8zb_46",secondary:"_secondary_uc8zb_55",purple:"_purple_uc8zb_64",orange:"_orange_uc8zb_73",modeIconWrapper:"_modeIconWrapper_uc8zb_82",modeIcon:"_modeIcon_uc8zb_82",modeName:"_modeName_uc8zb_117",modeDescription:"_modeDescription_uc8zb_124",modeAction:"_modeAction_uc8zb_131",startText:"_startText_uc8zb_137"},N=e.memo(({modes:e,onModeClick:t})=>a.jsx("section",{className:v.modesSection,children:a.jsx(s.div,{className:v.modesGrid,initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:e.map(e=>a.jsxs(s.div,{className:`${v.modeCard} ${v[e.color]}`,whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},onClick:()=>t(e),children:[a.jsx("div",{className:v.modeIconWrapper,children:a.jsx(e.icon,{className:v.modeIcon,size:32})}),a.jsx("h3",{className:v.modeName,children:e.label}),a.jsx("p",{className:v.modeDescription,children:e.description}),a.jsx("div",{className:v.modeAction,children:a.jsx("span",{className:v.startText,children:"Start →"})})]},e.id))})}));N.displayName="ModeSelector";const C="_cardsSection_jomxe_1",f="_sectionHeader_jomxe_18",y="_sectionTitle_jomxe_25",S="_cardActions_jomxe_32",M="_dragHint_jomxe_38",D="_cardsManagement_jomxe_44",z="_cardCategory_jomxe_61",T="_dragOver_jomxe_75",$="_learningSection_jomxe_80",w="_masteredSection_jomxe_84",A="_categoryTitle_jomxe_89",B="_categoryIcon_jomxe_99",I="_cardsList_jomxe_111",L="_emptyState_jomxe_125",P="_cardItem_jomxe_167",H="_dragging_jomxe_185",U="_masteredCard_jomxe_189",F="_cardDragHandle_jomxe_207",R="_cardNumber_jomxe_225",E="_cardContent_jomxe_234",O="_cardSide_jomxe_244",G="_sideLabel_jomxe_252",W="_sideText_jomxe_258",q="_masterButton_jomxe_268",J="_unmasterButton_jomxe_269",K=e.memo(({deck:i,learningCards:d,masteredCards:n,onCardClick:c,onToggleMastered:x})=>{const{showNotification:u}=t(),{markCardMastered:j,unmarkCardMastered:p}=r(),[g,b]=e.useState(null),[k,v]=e.useState(null),N=e.useRef(null);if(!i||!i.content||!i.metadata)return null;const K=()=>{b(null),N.current=null,v(null)},Q=e=>a=>{a.preventDefault(),v(e)},V=()=>{v(null)},X=e=>a=>{a.preventDefault();const s=N.current,t=i.metadata.deck_name;if(null===s||!t)return;const d=n.some(e=>e.idx===s);"mastered"!==e||d?"learning"===e&&d&&(p(t,s),u({message:"Card moved back to learning",type:"info",duration:2e3})):(j(t,s,i.content.length),u({message:"Card marked as mastered!",type:"success",duration:2e3})),v(null),K()},Y="ontouchstart"in window||navigator.maxTouchPoints>0,Z=i.metadata.side_labels?.side_a||"Side A",ee=i.metadata.side_labels?.side_b||"Side B",ae=(e,t)=>a.jsxs(s.div,{className:`${P} ${t?U:""} ${g===e.idx?H:""}`,draggable:!Y,onDragStart:Y?void 0:()=>{return a=e.idx,b(a),void(N.current=a);var a},onDragEnd:Y?void 0:K,initial:{opacity:0,x:-20},animate:{opacity:g===e.idx?.5:1,x:0},transition:{duration:.3},onClick:()=>c(e),whileHover:{backgroundColor:t?"rgba(16, 185, 129, 0.15)":"#F7F8FA"},layout:!0,children:[!Y&&a.jsx(m,{className:F,size:20}),a.jsx("div",{className:R,children:e.idx+1}),a.jsxs("div",{className:E,children:[a.jsxs("div",{className:O,children:[a.jsxs("span",{className:G,children:[Z,":"]}),a.jsx("span",{className:W,children:e.side_a})]}),a.jsxs("div",{className:O,children:[a.jsxs("span",{className:G,children:[ee,":"]}),a.jsx("span",{className:W,children:e.side_b})]})]}),a.jsx("button",{className:t?J:q,onClick:a=>{a.stopPropagation(),x(e.idx)},title:t?"Move back to learning":"Mark as mastered",children:t?a.jsx(_,{size:16}):a.jsx(h,{size:16})})]},e.idx);return a.jsxs("section",{className:C,children:[a.jsxs("div",{className:f,children:[a.jsxs("h2",{className:y,children:["Cards Management (",i.content.length," total)"]}),a.jsx("div",{className:S,children:"ontouchstart"in window||navigator.maxTouchPoints>0?null:a.jsx("span",{className:M,children:"Drag cards to categorize them"})})]}),a.jsxs("div",{className:D,children:[a.jsxs("div",{className:`${z} ${$} ${"learning"===k?T:""}`,onDragOver:Q("learning"),onDrop:X("learning"),onDragLeave:V,children:[a.jsxs("h3",{className:A,children:[a.jsx(o,{size:20,className:B}),"Learning (",d.length,")"]}),a.jsx("div",{className:I,children:d.length>0?d.map(e=>ae(e,!1)):a.jsxs("div",{className:L,children:[a.jsx("p",{children:"No cards in learning"}),a.jsx("span",{children:"ontouchstart"in window||navigator.maxTouchPoints>0?"Tap cards to categorize them":"Drag cards here to start learning"})]})})]}),a.jsxs("div",{className:`${z} ${w} ${"mastered"===k?T:""}`,onDragOver:Q("mastered"),onDrop:X("mastered"),onDragLeave:V,children:[a.jsxs("h3",{className:A,children:[a.jsx(l,{size:20,className:B}),"Mastered (",n.length,")"]}),a.jsx("div",{className:I,children:n.length>0?n.map(e=>ae(e,!0)):a.jsxs("div",{className:L,children:[a.jsx("p",{children:"No mastered cards"}),a.jsx("span",{children:"ontouchstart"in window||navigator.maxTouchPoints>0?"Cards appear here when marked as mastered":"Cards auto-populate here during learn mode or drag to mark as mastered"})]})})]})]})]})});K.displayName="CardManagement";const Q="_deckPage_vtcob_1",V="_backButton_vtcob_19",X="_errorContainer_vtcob_96",Y="_modalOverlay_vtcob_322",Z="_modalContent_vtcob_336",ee="_closeButton_vtcob_348",ae="_modalTitle_vtcob_371",se="_modalCard_vtcob_378",te="_modalSide_vtcob_384",ie=()=>{const{deckId:c}=i(),o=d(),{currentDeck:l,loadDeck:m,isLoading:_,error:h}=n(),{getMasteredCards:v,resetDeckMastery:C,mastery:f}=r(),{showNotification:y}=t(),{getSettingsForMode:S}=x(),[M,D]=e.useState(null),[z,T]=e.useState(!1),[$,w]=e.useState(!1);e.useEffect(()=>{c&&m(c)},[c,m]);const A=e.useMemo(()=>c?v(c):[],[c,v,f]),B=e.useMemo(()=>l?.content?l.content.filter(e=>!A.includes(e.idx)):[],[l,A]),I=e.useMemo(()=>l?.content?l.content.filter(e=>A.includes(e.idx)):[],[l,A]),L=e.useMemo(()=>[{id:"flashcards",label:"Flashcards",icon:j,color:"primary",description:"Classic flip cards for memorization",route:`/flashcards/${c}`},{id:"learn",label:"Learn",icon:p,color:"secondary",description:"Interactive questions with smart scheduling",route:`/learn/${c}`},{id:"match",label:"Match",icon:g,color:"purple",description:"Memory game to match terms and definitions",route:`/match/${c}`},{id:"read",label:"Read",icon:b,color:"orange",description:"Structured reading with line-by-line translation",route:`/read/${c}`}],[c]),P=e.useCallback(e=>{"read"!==e.id||l?.reading&&0!==Object.keys(l.reading.dialogues).length?o(e.route):y({message:"No reading content available for this deck",type:"info",duration:3e3})},[o,y,l]),H=e.useCallback(e=>{D(e),T(!0)},[]),U=e.useCallback(()=>{T(!1),setTimeout(()=>D(null),300)},[]),F=e.useCallback(e=>{if(!c||!l)return;const{markCardMastered:a,unmarkCardMastered:s}=r.getState(),t=A.includes(e);t?s(c,e):a(c,e,l.content.length),y({message:t?"Card moved back to learning":"Card marked as mastered!",type:t?"info":"success",duration:2e3})},[c,A,l,y]);return _?null:h||!l?a.jsxs("div",{className:X,children:[a.jsx("h2",{children:"Error Loading Deck"}),a.jsx("p",{children:h||"Deck not found"}),a.jsx("button",{onClick:()=>o("/"),className:V,children:"Back to Home"})]}):a.jsxs("div",{className:Q,children:[a.jsx(k,{deck:l,onBackClick:()=>o("/"),onSettingsClick:()=>w(!0)}),a.jsx(N,{modes:L,onModeClick:P}),a.jsx(K,{deck:l,learningCards:B,masteredCards:I,onCardClick:H,onToggleMastered:F}),z&&M&&a.jsx(s.div,{className:Y,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:U,children:a.jsxs(s.div,{className:Z,initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:e=>e.stopPropagation(),children:[a.jsx("button",{className:ee,onClick:U,children:"×"}),a.jsx("h3",{className:ae,children:"Card Details"}),a.jsxs("div",{className:se,children:[a.jsxs("div",{className:te,children:[a.jsx("h4",{children:l?.metadata?.side_labels?.side_a?l.metadata.side_labels.side_a.charAt(0).toUpperCase()+l.metadata.side_labels.side_a.slice(1):"Side A (Front)"}),a.jsx("p",{children:M.side_a})]}),a.jsxs("div",{className:te,children:[a.jsx("h4",{children:l?.metadata?.side_labels?.side_b?l.metadata.side_labels.side_b.charAt(0).toUpperCase()+l.metadata.side_labels.side_b.slice(1):"Side B (Back)"}),a.jsx("p",{children:M.side_b})]}),M.side_c&&a.jsxs("div",{className:te,children:[a.jsx("h4",{children:l?.metadata?.side_labels?.side_c?l.metadata.side_labels.side_c.charAt(0).toUpperCase()+l.metadata.side_labels.side_c.slice(1):"Side C (Extra)"}),a.jsx("p",{children:M.side_c})]}),M.side_d&&a.jsxs("div",{className:te,children:[a.jsx("h4",{children:l?.metadata?.side_labels?.side_d?l.metadata.side_labels.side_d.charAt(0).toUpperCase()+l.metadata.side_labels.side_d.slice(1):"Side D"}),a.jsx("p",{children:M.side_d})]}),M.side_e&&a.jsxs("div",{className:te,children:[a.jsx("h4",{children:l?.metadata?.side_labels?.side_e?l.metadata.side_labels.side_e.charAt(0).toUpperCase()+l.metadata.side_labels.side_e.slice(1):"Side E"}),a.jsx("p",{children:M.side_e})]}),M.side_f&&a.jsxs("div",{className:te,children:[a.jsx("h4",{children:l?.metadata?.side_labels?.side_f?l.metadata.side_labels.side_f.charAt(0).toUpperCase()+l.metadata.side_labels.side_f.slice(1):"Side F"}),a.jsx("p",{children:M.side_f})]})]})]})}),a.jsx(u,{visible:$,onClose:()=>w(!1),deck:l,mode:"deck",settings:c?S(c,"deck"):{frontSides:[],backSides:[],cardsPerRound:10,enableTimer:!1,enableAudio:!1,randomize:!1,progressionMode:"sequential"},onUpdateSettings:()=>{},onResetMastery:()=>{c&&(C(c),y({message:"Mastered cards reset for this deck.",type:"info",duration:2e3}))}})]})};export{ie as default};
