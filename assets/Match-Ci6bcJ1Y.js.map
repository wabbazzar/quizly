{"version":3,"file":"Match-Ci6bcJ1Y.js","sources":["../../src/pages/Match.tsx"],"sourcesContent":["import { FC, useEffect, useState, useCallback } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useDeckStore } from '@/store/deckStore';\nimport { useCardMasteryStore } from '@/store/cardMasteryStore';\n// import { useMatchSessionStore } from '@/store/matchSessionStore'; // Will be used in later phases\n// import { useProgressStore } from '@/store/progressStore'; // Will be used in Phase 4\nimport MatchContainer from '@/components/modes/match/MatchContainer';\n// import { MatchResults } from '@/components/modes/match/types'; // Will be used in Phase 4\nimport styles from './Match.module.css';\n\nconst Match: FC = () => {\n  const { deckId } = useParams<{ deckId: string }>();\n  const navigate = useNavigate();\n  const { decks, activeDeck, selectDeck, isLoading: deckLoading } = useDeckStore();\n  const { getMasteredCards } = useCardMasteryStore();\n  // const { loadSession } = useMatchSessionStore(); // Will be used in later phases\n  // const { updateDeckProgress } = useProgressStore(); // Will be used in Phase 4\n\n  // Local state\n  const [isInitialized, setIsInitialized] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Load deck and initialize\n  useEffect(() => {\n    if (!deckId) {\n      setError('No deck ID provided');\n      return;\n    }\n\n    // Find deck in loaded decks\n    const deck = decks.find(d => d.id === deckId);\n\n    if (deck) {\n      // Deck is available, select it\n      selectDeck(deckId);\n      setIsInitialized(true);\n      setError(null);\n    } else if (!deckLoading) {\n      // Deck not found and not loading\n      setError('Deck not found');\n    }\n    // If still loading, wait for decks to load\n  }, [deckId, decks, selectDeck, deckLoading]);\n\n  // Prevent body scrolling on mobile\n  useEffect(() => {\n    document.body.classList.add('no-scroll');\n\n    return () => {\n      document.body.classList.remove('no-scroll');\n    };\n  }, []);\n\n  // TODO: Handle session completion and progress tracking in Phase 4\n  // const handleSessionComplete = useCallback((results: MatchResults) => {\n  //   if (!deckId || !activeDeck) return;\n  //   // Implementation will be added in Phase 4 with results modal\n  // }, [deckId, activeDeck, updateDeckProgress]);\n\n  // Handle navigation back to deck\n  const handleBackToDeck = useCallback(() => {\n    if (deckId) {\n      navigate(`/deck/${deckId}`);\n    } else {\n      navigate('/');\n    }\n  }, [navigate, deckId]);\n\n  // Error handling\n  if (error) {\n    return (\n      <div className={styles.errorContainer}>\n        <div className={styles.errorContent}>\n          <h1>Match Mode Error</h1>\n          <p>{error}</p>\n          <button\n            onClick={() => navigate('/')}\n            className={styles.errorButton}\n          >\n            Return to Home\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Loading state - removed LoadingScreen to avoid duplicate with PageLazyBoundary\n  if (deckLoading || !isInitialized || !activeDeck) {\n    return null; // Let PageLazyBoundary handle loading state\n  }\n\n  // Check if deck has enough cards for match mode\n  if (activeDeck.content.length < 2) {\n    return (\n      <div className={styles.errorContainer}>\n        <div className={styles.errorContent}>\n          <h1>Insufficient Cards</h1>\n          <p>\n            This deck needs at least 2 cards to play Match mode.\n            Current deck has {activeDeck.content.length} card{activeDeck.content.length === 1 ? '' : 's'}.\n          </p>\n          <button\n            onClick={handleBackToDeck}\n            className={styles.errorButton}\n          >\n            Back to Deck\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Check for mastered cards scenario\n  const masteredIndices = getMasteredCards(deckId!);\n  const availableCards = activeDeck.content.length - masteredIndices.length;\n\n  if (availableCards < 2 && masteredIndices.length > 0) {\n    return (\n      <div className={styles.errorContainer}>\n        <div className={styles.errorContent}>\n          <h1>All Cards Mastered</h1>\n          <p>\n            You've mastered most cards in this deck!\n            Only {availableCards} unmastered card{availableCards === 1 ? '' : 's'} remaining.\n          </p>\n          <p>\n            Enable \"Include Mastered Cards\" in settings to continue playing.\n          </p>\n          <button\n            onClick={handleBackToDeck}\n            className={styles.errorButton}\n          >\n            Back to Deck\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={styles.container}>\n      <MatchContainer\n        deck={activeDeck}\n      />\n    </div>\n  );\n};\n\nexport default Match;"],"names":["Match","deckId","useParams","navigate","useNavigate","decks","activeDeck","selectDeck","isLoading","deckLoading","useDeckStore","getMasteredCards","useCardMasteryStore","isInitialized","setIsInitialized","useState","error","setError","useEffect","find","d","id","document","body","classList","add","remove","handleBackToDeck","useCallback","jsx","className","styles","errorContainer","children","jsxs","errorContent","onClick","errorButton","content","length","masteredIndices","availableCards","container","MatchContainer","deck"],"mappings":"qVAUA,MAAMA,EAAY,KAChB,MAAMC,OAAEA,GAAWC,IACbC,EAAWC,KACXC,MAAEA,EAAAC,WAAOA,EAAAC,WAAYA,EAAYC,UAAWC,GAAgBC,KAC5DC,iBAAEA,GAAqBC,KAKtBC,EAAeC,GAAoBC,EAAAA,UAAS,IAC5CC,EAAOC,GAAYF,EAAAA,SAAwB,MAGlDG,EAAAA,UAAU,KACR,IAAKjB,EAEH,YADAgB,EAAS,uBAKEZ,EAAMc,KAAKC,GAAKA,EAAEC,KAAOpB,IAIpCM,EAAWN,GACXa,GAAiB,GACjBG,EAAS,OACCR,GAEVQ,EAAS,mBAGV,CAAChB,EAAQI,EAAOE,EAAYE,IAG/BS,EAAAA,UAAU,KACRI,SAASC,KAAKC,UAAUC,IAAI,aAErB,KACLH,SAASC,KAAKC,UAAUE,OAAO,eAEhC,IASH,MAAMC,EAAmBC,EAAAA,YAAY,KAEjCzB,EADEF,EACO,SAASA,IAET,MAEV,CAACE,EAAUF,IAGd,GAAIe,EACF,OACEa,EAAAA,IAAC,OAAIC,UAAWC,EAAOC,eACrBC,SAAAC,EAAAA,KAAC,MAAA,CAAIJ,UAAWC,EAAOI,aACrBF,SAAA,CAAAJ,EAAAA,IAAC,MAAGI,SAAA,qBACJJ,EAAAA,IAAC,KAAGI,SAAAjB,IACJa,EAAAA,IAAC,SAAA,CACCO,QAAS,IAAMjC,EAAS,KACxB2B,UAAWC,EAAOM,YACnBJ,SAAA,wBAST,GAAIxB,IAAgBI,IAAkBP,EACpC,OAAO,KAIT,GAAIA,EAAWgC,QAAQC,OAAS,EAC9B,OACEV,EAAAA,IAAC,OAAIC,UAAWC,EAAOC,eACrBC,SAAAC,EAAAA,KAAC,MAAA,CAAIJ,UAAWC,EAAOI,aACrBF,SAAA,CAAAJ,EAAAA,IAAC,MAAGI,SAAA,8BACH,IAAA,CAAEA,SAAA,CAAA,yEAEiB3B,EAAWgC,QAAQC,OAAO,QAAoC,IAA9BjC,EAAWgC,QAAQC,OAAe,GAAK,IAAI,OAE/FV,EAAAA,IAAC,SAAA,CACCO,QAAST,EACTG,UAAWC,EAAOM,YACnBJ,SAAA,sBAST,MAAMO,EAAkB7B,EAAiBV,GACnCwC,EAAiBnC,EAAWgC,QAAQC,OAASC,EAAgBD,OAEnE,OAAIE,EAAiB,GAAKD,EAAgBD,OAAS,EAE/CV,EAAAA,IAAC,OAAIC,UAAWC,EAAOC,eACrBC,SAAAC,EAAAA,KAAC,MAAA,CAAIJ,UAAWC,EAAOI,aACrBF,SAAA,CAAAJ,EAAAA,IAAC,MAAGI,SAAA,8BACH,IAAA,CAAEA,SAAA,CAAA,iDAEKQ,EAAe,mBAAoC,IAAnBA,EAAuB,GAAK,IAAI,iBAExEZ,EAAAA,IAAC,KAAEI,SAAA,qEAGHJ,EAAAA,IAAC,SAAA,CACCO,QAAST,EACTG,UAAWC,EAAOM,YACnBJ,SAAA,sBASPJ,EAAAA,IAAC,MAAA,CAAIC,UAAWC,EAAOW,UACrBT,SAAAJ,EAAAA,IAACc,EAAA,CACCC,KAAMtC"}