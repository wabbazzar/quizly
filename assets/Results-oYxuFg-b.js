import{r as e,j as s,f as a,u as i,g as d,d as t,m as l}from"./index-CoElTYbf.js";const n="_reviewCard_2g1av_1",r="_expanded_2g1av_18",c="_side_2g1av_29",_="_sideLabel_2g1av_36",o="_content_2g1av_44",h="_divider_2g1av_51",u="_flipCard_2g1av_57",m="_flipHint_2g1av_67",x="_level_2g1av_74",j=({card:a,frontSides:i=["side_a"],backSides:d=["side_b"],showBothSides:t=!1})=>{const[l,j]=e.useState(!1),g=i.filter(e=>a[e]).map(e=>a[e]).join(" • "),p=d.filter(e=>a[e]).map(e=>a[e]).join(" • ");return s.jsxs("div",{className:`${n} ${t?r:""}`,onClick:()=>{t||j(!l)},role:t?void 0:"button",tabIndex:t?void 0:0,"aria-label":t?void 0:"Click to flip card",children:[t?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:c,children:[s.jsx("div",{className:_,children:"Question"}),s.jsx("div",{className:o,children:g})]}),s.jsx("div",{className:h}),s.jsxs("div",{className:c,children:[s.jsx("div",{className:_,children:"Answer"}),s.jsx("div",{className:o,children:p})]})]}):s.jsxs("div",{className:u,children:[s.jsx("div",{className:o,children:l?p:g}),!t&&s.jsx("div",{className:m,children:l?"Click to see question":"Click to see answer"})]}),a.level&&s.jsxs("div",{className:x,children:["Level ",a.level]})]})},g="_resultsPage_10u1k_1",p="_noScroll_10u1k_10",v="_resultsContainer_10u1k_15",k="_header_10u1k_25",C="_title_10u1k_32",N="_accuracy_10u1k_39",b="_statsLine_10u1k_46",f="_statsDot_10u1k_56",S="_reviewNote_10u1k_65",w="_actionButtons_10u1k_74",y="_actionButton_10u1k_74",$="_primaryButton_10u1k_92",A="_secondaryButton_10u1k_101",B="_tertiaryButton_10u1k_110",D="_missedCardsSection_10u1k_129",E="_missedCardsTitle_10u1k_135",L="_missedCardsGrid_10u1k_143",U="_modalOverlay_10u1k_184",T="_modalContent_10u1k_199",M="_closeButton_10u1k_211",F="_modalTitle_10u1k_234",G="_modalCard_10u1k_241",H="_modalSide_10u1k_247",P=()=>{const{deckId:n}=a(),r=i(),c=d(),{currentDeck:_,loadDeck:o}=t(),[h,u]=e.useState(null),[m,x]=e.useState(!1),P=c.state?.results;if(e.useEffect(()=>{n&&!_&&o(n)},[n,_,o]),!P)return r("/"),null;const I=Math.round(P.accuracy),O=Math.round(P.duration/1e3),Q=Math.floor(O/60),q=O%60,K=()=>{const e=_?.content?.length||0,s=P.passedCards?.length||0;if(e>0&&s>=e)return alert("You have passed all cards in this deck."),void r(`/deck/${n}`);const a=P.passedCards?.length>0?P.passedCards:[];r(`/learn/${n}`,{state:{excludeCards:a,strugglingCards:P.strugglingCards||[]}})},R=()=>{r(`/deck/${n}`)},V=()=>{r("/")},Y=()=>{x(!1),setTimeout(()=>u(null),300)};return e.useEffect(()=>{const e=e=>{if(!e.repeat&&!(e=>{if(!(e instanceof HTMLElement))return!1;const s=e.tagName.toLowerCase();return"input"===s||"textarea"===s||e.isContentEditable||"select"===s})(e.target)&&!m)switch(e.key){case"1":e.preventDefault(),K();break;case"2":e.preventDefault(),R();break;case"3":e.preventDefault(),V()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[K,R,V,m]),s.jsx("div",{className:`${g} ${P.strugglingCards.length<=1?p:""}`,children:s.jsxs("div",{className:v,children:[s.jsxs("div",{className:k,children:[s.jsx("h1",{className:C,children:_&&P.passedCards?.length>=_.content.length?"All Cards Passed!":I>=90?"Outstanding!":I>=75?"Great job!":I>=60?"Good effort!":"Keep practicing!"}),s.jsxs("span",{className:N,children:[I,"%"]})]}),s.jsxs("div",{className:b,children:[s.jsxs("span",{children:[P.correctAnswers,"/",P.totalQuestions," correct"]}),s.jsx("span",{className:f}),s.jsxs("span",{children:[P.maxStreak," streak"]}),s.jsx("span",{className:f}),s.jsxs("span",{children:[Q,":",q.toString().padStart(2,"0")]})]}),P.strugglingCards.length>0&&s.jsxs("p",{className:S,children:[P.strugglingCards.length," card",1!==P.strugglingCards.length?"s":""," to review"]}),s.jsxs("div",{className:w,children:[s.jsx("button",{onClick:K,className:`${y} ${$}`,children:_&&P.passedCards?.length>=_.content.length?"View Deck":P.passedCards?.length>0?"Continue with New Cards":"Try Again"}),s.jsx("button",{onClick:R,className:`${y} ${A}`,children:"Back to Deck"}),s.jsx("button",{onClick:V,className:`${y} ${B}`,children:"Home"})]}),_&&P.strugglingCards&&P.strugglingCards.length>0&&s.jsxs("div",{className:D,children:[s.jsx("h2",{className:E,children:"Cards to Review"}),s.jsx("div",{className:L,children:P.strugglingCards.map(e=>{const a=_.content[e];return a?s.jsx("div",{onClick:()=>(e=>{u(e),x(!0)})(a),style:{cursor:"pointer"},children:s.jsx(j,{card:a,frontSides:["side_a"],backSides:["side_b"],showBothSides:!0})},e):null})})]}),m&&h&&s.jsx(l.div,{className:U,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:Y,children:s.jsxs(l.div,{className:T,initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:e=>e.stopPropagation(),children:[s.jsx("button",{className:M,onClick:Y,children:"×"}),s.jsx("h3",{className:F,children:"Card Details"}),s.jsxs("div",{className:G,children:[s.jsxs("div",{className:H,children:[s.jsx("h4",{children:_?.metadata?.side_labels?.side_a?_.metadata.side_labels.side_a.charAt(0).toUpperCase()+_.metadata.side_labels.side_a.slice(1):"Side A (Front)"}),s.jsx("p",{children:h.side_a})]}),s.jsxs("div",{className:H,children:[s.jsx("h4",{children:_?.metadata?.side_labels?.side_b?_.metadata.side_labels.side_b.charAt(0).toUpperCase()+_.metadata.side_labels.side_b.slice(1):"Side B (Back)"}),s.jsx("p",{children:h.side_b})]}),h.side_c&&s.jsxs("div",{className:H,children:[s.jsx("h4",{children:_?.metadata?.side_labels?.side_c?_.metadata.side_labels.side_c.charAt(0).toUpperCase()+_.metadata.side_labels.side_c.slice(1):"Side C (Extra)"}),s.jsx("p",{children:h.side_c})]}),h.side_d&&s.jsxs("div",{className:H,children:[s.jsx("h4",{children:_?.metadata?.side_labels?.side_d?_.metadata.side_labels.side_d.charAt(0).toUpperCase()+_.metadata.side_labels.side_d.slice(1):"Side D"}),s.jsx("p",{children:h.side_d})]}),h.side_e&&s.jsxs("div",{className:H,children:[s.jsx("h4",{children:_?.metadata?.side_labels?.side_e?_.metadata.side_labels.side_e.charAt(0).toUpperCase()+_.metadata.side_labels.side_e.slice(1):"Side E"}),s.jsx("p",{children:h.side_e})]}),h.side_f&&s.jsxs("div",{className:H,children:[s.jsx("h4",{children:_?.metadata?.side_labels?.side_f?_.metadata.side_labels.side_f.charAt(0).toUpperCase()+_.metadata.side_labels.side_f.slice(1):"Side F"}),s.jsx("p",{children:h.side_f})]})]})]})})]})})};export{P as default};
